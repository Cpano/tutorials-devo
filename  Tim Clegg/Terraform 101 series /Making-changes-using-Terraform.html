<!--======================================== EXTERNAL STYLES & CALENDAR ICON========================================-->
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style"
    onload="this.onload=null;this.rel='stylesheet'">

<link rel="stylesheet" href="https://cpano.github.io/tutorials-devo/public/css/TutorialsStyles.css">


<!--========================================HEADER========================================-->
<!-- CC01v0 -->
<section style="background-image:url(/a/devo/images/cc01-weblogic-hero-banner.jpg);" class="cc01 cc01v0  txtlight cpad">
    <div class="cc01w1 cwidth">

        <h1>Making changes using Terraform</h1>
        <p>Most environments tend to change on a regular basis. These changes can be easily managed in a reliable,
            scalable way using Terraform. </p>

        <div style="display: flex; color: white;">
            <p class="page__date" style="margin-right: 25px;"><strong><i class="fas fa-user fa-calendar-alt"
                        aria-hidden="true"></i>
                    Author: </strong>
                Tim Clegg
            </p>

            <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>
                    Updated:</strong>
                <time>September 30, 2021</time>
            </p>

        </div>

    </div>
</section>
<!-- /CC01v0 -->

<!-- F19v0 -->
<section class="f19 f19v0 cpad">
    <div class="f19w1 cwidth">
        <div class="f19w2 f19-2col">
            <div class="f19col f19side">
                <!-- S20v0 -->
                <section class="s20 s20v0 cpad" data-ocomid="s20" data-trackas="s20">
                    <div class="s20w1 cwidth">
                        <div class="col-w1">
                            <h3>Steps to follow</h3>
                            <div class="s20w2">
                                <ul>

                                    <!--<li><strong><a href="#link0">Intro</a></strong></li>-->
                                    <li><strong><a href="#link1">1. Intro</a></strong></li>
                                    <!--
                                    <li style="margin-left:15px;"><a href="#link1s1">Data</a></li>
                                    <li style="margin-left:15px;"><a href="#link1s2">Environments</a></li>
                                    -->
                                    <li><strong><a href="#slide-1">2. Prerequisites</a></strong></li>
                                    <li><strong><a href="#slide-2">3. Managing Change</a></strong></li>
                                    <li><strong><a href="#slide-3">4. Adding a Resource</a></strong></li>
                                    <li><strong><a href="#slide-4">5. Modifying a Resource</a></strong></li>
                                    <br />

                                </ul>
                            </div>

                            <h3>About Tim Clegg</h3>

                            <!--Social Icons-->
                            <div class="author__urls-wrapper" style="margin-bottom: 15px;">
                                <ul class="author__urls social-icons">
                                    <li>
                                        <a href="https://www.linkedin.com/in/timothy-clegg/" itemprop="sameAs"
                                            rel="nofollow noopener noreferrer" target="_blank">
                                            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span
                                                class="label">LinkedIn</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://github.com/timclegg" itemprop="sameAs"
                                            rel="nofollow noopener noreferrer" target="_blank">
                                            <i class="fab fa-fw fa-github" aria-hidden="true"></i><span
                                                class="label">GitHub</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <br><br>
                            <!-- End Social Icons-->
                            <p>Code. Share. Secure. Innovate. Automate. Educate.</p>

                            <p><strong>More tutorials from this author: <br> </strong>
                                <span class="tags">

                                    <li><a class="animated-link tag2"
                                            href="/tutorials/tf-101/3-understanding-terraform-basics">Understanding
                                            The Basics Of Terraform</a></li><br>

                                    <li><a class="animated-link tag2" href="/tutorials/tf-101/5-creating">Creating
                                            Resources with Terraform</a></li><br>

                                    <li><a class="animated-link tag2" href="/tutorials/tf-101/6-changing">Making
                                            changes using Terraform</a></li><br>

                                    <li><a class="animated-link tag2" href="/tutorials/tf-101/7-destroying">Destroying
                                            resources with
                                            Terraform</a></li><br>

                                    <li><a class="animated-link tag2" href="/tutorials/steampipe/">Steampipe on
                                            Oracle Cloud Infrastructure</a></li><br><br>

                                </span>
                            </p>

                            <!--Tags-->
                            <h3>Tags</h3>
                            <p> <span class=" tags">
                                    <a class="animated-link tag" href="#">open-source</a>
                                    <a class="animated-link tag" href="#">terraform</a>
                                    <a class="animated-link tag" href="#">iac</a>
                                    <a class="animated-link tag" href="#">devops</a>
                                    <a class="animated-link tag" href="#">get-started</a>
                                </span>
                            </p>

                            <h3></h3>
                            <a href="https://developer.oracle.com/tutorials">
                                <p class="page__date" style="margin-right: 25px;"><strong>
                                        Back to tutorials
                                    </strong>
                                </p>
                            </a>

                        </div>
                    </div>
                </section> <!-- /S20v0 -->
            </div> <!-- SET UP -->
            <main class="f19col f19main">


                <!-- cc01v0 -->
                <section class="cc01 cc01v0 cpad">
                    <div class="cc01w1 cwidth">



                        <h2 class="slide__title"><span class="slide__num">1</span> Introduction</h2>

                        <figure class="aligncenter">
                            <picture>
                                <source srcset="https://cool.devo.build/tutorials/tf-101/assets/terraform-101.png 1x" />
                                <img loading="lazy" width="400" height="400" src="https://cool.devo.build/tutorials/tf-101/assets/terraform-101.png"
                                    data-original="https://cool.devo.build/tutorials/tf-101/assets/terraform-101.png" data-at2x="https://cool.devo.build/tutorials/tf-101/assets/terraform-101@2x.png"
                                    title="Terraform 101" alt="Terraform 101 Tutorial Series" />
                            </picture>
                            <figcaption>Terraform 101</figcaption>
                        </figure>

                        <p>Most environments tend to change on a regular basis. These changes can be easily managed in a
                            reliable, scalable way using Terraform. Let’s try this out now.</p>

                    </div>

                    <div class="slide" id="slide-1">

                        <h2 class="slide__title"><span class="slide__num">2</span> Prerequisites</h2>

                        <p>It’s assumed that you’re building off of the environment built in the <a
                                href="/tutorials/tf-101/5-creating">Creating Resources with Terraform tutorial</a>.</p>

                    </div>

                    <div class="slide" id="slide-2">

                        <h2 class="slide__title"><span class="slide__num">3</span> Managing Change</h2>

                        <p>When managing an environment with Terraform, there are largely three data sources that
                            Terraform relies on:</p>

                        <ul>
                            <li>Terraform Code</li>
                            <li>Terraform State</li>
                            <li>Environment As-Built</li>
                        </ul>

                        <h3 id="terraform-code">Terraform Code</h3>
                        <p>The Terraform code is where you tell Terraform what you want it to manage. As you’ve already
                            seen, the Terraform code is just plain-text files with a <code
                                class="language-plaintext highlighter-rouge">.tf</code> extension.</p>

                        <p>Many teams find it beneficial to commit their Terraform source code to a version control
                            system (VCS) such as a git repository. The VCS allows for limiting access to the source code
                            (which can effectively contain your Oracle Cloud Infrastructure (OCI) topology, assuming
                            it’s defined in Terraform code). Another benefit to using a VCS is having a natural audit
                            trail of what has transpired in the environment (who-did-what-and-when).</p>

                        <h3 id="terraform-state">Terraform State</h3>
                        <p>The Terraform state is a critical piece of information that Terraform will use upon each
                            execution, cross-referencing what is deployed against the code and against what is cached in
                            the state. Additional resource data points are stored in the state, such as the OCID for a
                            resource (after it’s been created) as well as many other attributes that might not be
                            explicitly set in the Terraform code.</p>

                        <p>When working as a team, it’s important that each team member have a current, up-to-date copy
                            of the Terraform state. To keep things consistent, only one member of the team should make
                            changes to the environment at any single point in time.</p>

                        <p>By default, the Terraform state is stored in the <code
                                class="language-plaintext highlighter-rouge">terraform.tfstate</code> file located in
                            the working directory. There are several options for managing the Terraform State, but for
                            now we’ll be using the <a
                                href="https://www.terraform.io/docs/language/settings/backends/local.html">local
                                backend</a> (which happens to be the default).</p>

                        <h3 id="environment-as-built">Environment As-Built</h3>
                        <p>The actual OCI (or other environment) resources that are present (or missing). While this
                            isn’t really part of the Terraform configuration, managing resources is the reason that
                            Terraform is being used. Each run, Terraform will check the current as-built state of the
                            environment, comparing it against the Terraform State and the code that is provided, to
                            determine what might need to take place to bring the actual environment configuration into
                            alignment with the desired end-state configuration given in the Terraform code.</p>

                    </div>

                    <div class="slide" id="slide-3">

                        <h2 class="slide__title"><span class="slide__num">4</span> Adding a Resource</h2>

                        <p>To start, let’s add three new Subnets to the Virtual Cloud Network (VCN) that was created in
                            the <a href="/tutorials/tf-101/5-creating">previous tutorial</a>. Add the following to your <code
                                class="language-plaintext highlighter-rouge">main.tf</code> file:</p>

                        <div class="language-terraform highlighter-rouge">
                            <div class="highlight">
                                <pre class="highlight"><code><span class="k">resource</span> <span class="s2">"oci_core_subnet"</span> <span class="s2">"dev_1"</span> <span class="p">{</span>
                      <span class="nx">vcn_id</span>                      <span class="p">=</span> <span class="nx">oci_core_vcn</span><span class="p">.</span><span class="nx">tf_101</span><span class="p">.</span><span class="nx">id</span>
                      <span class="nx">cidr_block</span>                  <span class="p">=</span> <span class="s2">"172.16.0.0/24"</span>
                      <span class="nx">compartment_id</span>              <span class="p">=</span> <span class="s2">"&lt;your_compartment_OCID_here&gt;"</span>
                      <span class="nx">display_name</span>                <span class="p">=</span> <span class="s2">"Dev subnet 1"</span>
                      <span class="nx">prohibit_public_ip_on_vnic</span>  <span class="p">=</span> <span class="kc">true</span>
                      <span class="nx">dns_label</span>                   <span class="p">=</span> <span class="s2">"dev"</span>
                    <span class="p">}</span>
                    
                    <span class="k">resource</span> <span class="s2">"oci_core_subnet"</span> <span class="s2">"test"</span> <span class="p">{</span>
                      <span class="nx">vcn_id</span>                      <span class="p">=</span> <span class="nx">oci_core_vcn</span><span class="p">.</span><span class="nx">tf_101</span><span class="p">.</span><span class="nx">id</span>
                      <span class="nx">cidr_block</span>                  <span class="p">=</span> <span class="s2">"172.16.1.0/24"</span>
                      <span class="nx">compartment_id</span>              <span class="p">=</span> <span class="s2">"&lt;your_compartment_OCID_here&gt;"</span>
                      <span class="nx">display_name</span>                <span class="p">=</span> <span class="s2">"Testing subnet"</span>
                      <span class="nx">prohibit_public_ip_on_vnic</span>  <span class="p">=</span> <span class="kc">true</span>
                      <span class="nx">dns_label</span>                   <span class="p">=</span> <span class="s2">"test"</span>
                    <span class="p">}</span>
                    
                    <span class="k">resource</span> <span class="s2">"oci_core_subnet"</span> <span class="s2">"stage"</span> <span class="p">{</span>
                      <span class="nx">vcn_id</span>                      <span class="p">=</span> <span class="nx">oci_core_vcn</span><span class="p">.</span><span class="nx">tf_101</span><span class="p">.</span><span class="nx">id</span>
                      <span class="nx">cidr_block</span>                  <span class="p">=</span> <span class="s2">"172.16.2.0/24"</span>
                      <span class="nx">compartment_id</span>              <span class="p">=</span> <span class="s2">"&lt;your_compartment_OCID_here&gt;"</span>
                      <span class="nx">display_name</span>                <span class="p">=</span> <span class="s2">"Staging subnet"</span>
                      <span class="nx">prohibit_public_ip_on_vnic</span>  <span class="p">=</span> <span class="kc">true</span>
                      <span class="nx">dns_label</span>                   <span class="p">=</span> <span class="s2">"stage"</span>
                    <span class="p">}</span>
                    </code></pre>
                            </div>
                        </div>

                        <blockquote class="notice">
                            <p><strong>NOTE:</strong> Make sure to use the compartment_id you wish to use.</p>
                        </blockquote>

                        <p>The above code adds three new subnets: one development Subnet, one testing Subnet and, one
                            staging Subnet. Each of these is placed in the compartment specified, within the VCN that
                            was created in the <a href="/tutorials/tf-101/5-creating">previous tutorial</a>. Each has a unique IPv4 CIDR
                            block which falls within the broader VCN IPv4 CIDR block. None of the subnets permits public
                            IPs to be used (they’re prohibited).</p>

                        <p>Confirm that this will do what is intended by examining the Terraform plan:</p>

                        <div class="language-console highlighter-rouge">
                            <div class="highlight">
                                <pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>terraform plan
                    <span class="gp">oci_core_vcn.tf_101: Refreshing state... [id=ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="go">
                    An execution plan has been generated and is shown below.
                    Resource actions are indicated with the following symbols:
                      + create
                    
                    Terraform will perform the following actions:
                    
                    </span><span class="gp">  #</span><span class="w"> </span>oci_core_subnet.dev_1 will be created
                    <span class="go">  + resource "oci_core_subnet" "dev_1" {
                          + availability_domain        = (known after apply)
                          + cidr_block                 = "172.16.0.0/24"
                    </span><span class="gp">      + compartment_id             = "ocid1.compartment.oc1.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + defined_tags               = (known after apply)
                          + dhcp_options_id            = (known after apply)
                          + display_name               = "Dev subnet 1"
                          + dns_label                  = "dev"
                          + freeform_tags              = (known after apply)
                          + id                         = (known after apply)
                          + ipv6cidr_block             = (known after apply)
                          + ipv6public_cidr_block      = (known after apply)
                          + ipv6virtual_router_ip      = (known after apply)
                          + prohibit_public_ip_on_vnic = true
                          + route_table_id             = (known after apply)
                          + security_list_ids          = (known after apply)
                          + state                      = (known after apply)
                          + subnet_domain_name         = (known after apply)
                          + time_created               = (known after apply)
                    </span><span class="gp">      + vcn_id                     = "ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + virtual_router_ip          = (known after apply)
                          + virtual_router_mac         = (known after apply)
                        }
                    
                    </span><span class="gp">  #</span><span class="w"> </span>oci_core_subnet.stage will be created
                    <span class="go">  + resource "oci_core_subnet" "stage" {
                          + availability_domain        = (known after apply)
                          + cidr_block                 = "172.16.2.0/24"
                    </span><span class="gp">      + compartment_id             = "ocid1.compartment.oc1.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + defined_tags               = (known after apply)
                          + dhcp_options_id            = (known after apply)
                          + display_name               = "Staging subnet"
                          + dns_label                  = "stage"
                          + freeform_tags              = (known after apply)
                          + id                         = (known after apply)
                          + ipv6cidr_block             = (known after apply)
                          + ipv6public_cidr_block      = (known after apply)
                          + ipv6virtual_router_ip      = (known after apply)
                          + prohibit_public_ip_on_vnic = true
                          + route_table_id             = (known after apply)
                          + security_list_ids          = (known after apply)
                          + state                      = (known after apply)
                          + subnet_domain_name         = (known after apply)
                          + time_created               = (known after apply)
                    </span><span class="gp">      + vcn_id                     = "ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + virtual_router_ip          = (known after apply)
                          + virtual_router_mac         = (known after apply)
                        }
                    
                    </span><span class="gp">  #</span><span class="w"> </span>oci_core_subnet.test will be created
                    <span class="go">  + resource "oci_core_subnet" "test" {
                          + availability_domain        = (known after apply)
                          + cidr_block                 = "172.16.1.0/24"
                    </span><span class="gp">      + compartment_id             = "ocid1.compartment.oc1.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + defined_tags               = (known after apply)
                          + dhcp_options_id            = (known after apply)
                          + display_name               = "Testing subnet"
                          + dns_label                  = "test"
                          + freeform_tags              = (known after apply)
                          + id                         = (known after apply)
                          + ipv6cidr_block             = (known after apply)
                          + ipv6public_cidr_block      = (known after apply)
                          + ipv6virtual_router_ip      = (known after apply)
                          + prohibit_public_ip_on_vnic = true
                          + route_table_id             = (known after apply)
                          + security_list_ids          = (known after apply)
                          + state                      = (known after apply)
                          + subnet_domain_name         = (known after apply)
                          + time_created               = (known after apply)
                    </span><span class="gp">      + vcn_id                     = "ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + virtual_router_ip          = (known after apply)
                          + virtual_router_mac         = (known after apply)
                        }
                    
                    Plan: 3 to add, 0 to change, 0 to destroy.
                    
                    ------------------------------------------------------------------------
                    
                    Note: You didn't specify an "-out" parameter to save this plan, so Terraform
                    can't guarantee that exactly these actions will be performed if
                    "terraform apply" is subsequently run.
                    </span></code></pre>
                            </div>
                        </div>

                        <p>The plus sign (+) next to the three subnets listed in the above output means that Terraform
                            is going to add three Subnet resources to your environment. The existing VCN resource will
                            remain unchanged.</p>

                        <p>Being satisfied with this plan, apply it (to implement it).</p>

                        <div class="language-console highlighter-rouge">
                            <div class="highlight">
                                <pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>terraform apply
                    <span class="gp">oci_core_vcn.tf_101: Refreshing state... [id=ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="go">
                    An execution plan has been generated and is shown below.
                    Resource actions are indicated with the following symbols:
                      + create
                    
                    Terraform will perform the following actions:
                    
                    </span><span class="gp">  #</span><span class="w"> </span>oci_core_subnet.dev_1 will be created
                    <span class="go">  + resource "oci_core_subnet" "dev_1" {
                          + availability_domain        = (known after apply)
                          + cidr_block                 = "172.16.0.0/24"
                    </span><span class="gp">      + compartment_id             = "ocid1.compartment.oc1..&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + defined_tags               = (known after apply)
                          + dhcp_options_id            = (known after apply)
                          + display_name               = "Dev subnet 1"
                          + dns_label                  = "dev"
                          + freeform_tags              = (known after apply)
                          + id                         = (known after apply)
                          + ipv6cidr_block             = (known after apply)
                          + ipv6public_cidr_block      = (known after apply)
                          + ipv6virtual_router_ip      = (known after apply)
                          + prohibit_public_ip_on_vnic = true
                          + route_table_id             = (known after apply)
                          + security_list_ids          = (known after apply)
                          + state                      = (known after apply)
                          + subnet_domain_name         = (known after apply)
                          + time_created               = (known after apply)
                    </span><span class="gp">      + vcn_id                     = "ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + virtual_router_ip          = (known after apply)
                          + virtual_router_mac         = (known after apply)
                        }
                    
                    </span><span class="gp">  #</span><span class="w"> </span>oci_core_subnet.stage will be created
                    <span class="go">  + resource "oci_core_subnet" "stage" {
                          + availability_domain        = (known after apply)
                          + cidr_block                 = "172.16.2.0/24"
                    </span><span class="gp">      + compartment_id             = "ocid1.compartment.oc1..&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + defined_tags               = (known after apply)
                          + dhcp_options_id            = (known after apply)
                          + display_name               = "Staging subnet"
                          + dns_label                  = "stage"
                          + freeform_tags              = (known after apply)
                          + id                         = (known after apply)
                          + ipv6cidr_block             = (known after apply)
                          + ipv6public_cidr_block      = (known after apply)
                          + ipv6virtual_router_ip      = (known after apply)
                          + prohibit_public_ip_on_vnic = true
                          + route_table_id             = (known after apply)
                          + security_list_ids          = (known after apply)
                          + state                      = (known after apply)
                          + subnet_domain_name         = (known after apply)
                          + time_created               = (known after apply)
                    </span><span class="gp">      + vcn_id                     = "ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + virtual_router_ip          = (known after apply)
                          + virtual_router_mac         = (known after apply)
                        }
                    
                    </span><span class="gp">  #</span><span class="w"> </span>oci_core_subnet.test will be created
                    <span class="go">  + resource "oci_core_subnet" "test" {
                          + availability_domain        = (known after apply)
                          + cidr_block                 = "172.16.1.0/24"
                    </span><span class="gp">      + compartment_id             = "ocid1.compartment.oc1.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + defined_tags               = (known after apply)
                          + dhcp_options_id            = (known after apply)
                          + display_name               = "Testing subnet"
                          + dns_label                  = "test"
                          + freeform_tags              = (known after apply)
                          + id                         = (known after apply)
                          + ipv6cidr_block             = (known after apply)
                          + ipv6public_cidr_block      = (known after apply)
                          + ipv6virtual_router_ip      = (known after apply)
                          + prohibit_public_ip_on_vnic = true
                          + route_table_id             = (known after apply)
                          + security_list_ids          = (known after apply)
                          + state                      = (known after apply)
                          + subnet_domain_name         = (known after apply)
                          + time_created               = (known after apply)
                    </span><span class="gp">      + vcn_id                     = "ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + virtual_router_ip          = (known after apply)
                          + virtual_router_mac         = (known after apply)
                        }
                    
                    Plan: 3 to add, 0 to change, 0 to destroy.
                    
                    Do you want to perform these actions?
                      Terraform will perform the actions described above.
                      Only 'yes' will be accepted to approve.
                    
                      Enter a value: yes
                    
                    oci_core_subnet.stage: Creating...
                    oci_core_subnet.test: Creating...
                    oci_core_subnet.dev_1: Creating...
                    </span><span class="gp">oci_core_subnet.stage: Creation complete after 7s [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="gp">oci_core_subnet.test: Creation complete after 8s [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="go">oci_core_subnet.dev_1: Still creating... [10s elapsed]
                    </span><span class="gp">oci_core_subnet.dev_1: Creation complete after 12s [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="go">
                    Apply complete! Resources: 3 added, 0 changed, 0 destroyed.
                    </span></code></pre>
                            </div>
                        </div>

                        <p>Voila! Your VCN now has three subnets in it. This was a really easy way to add OCI resources
                            to the VCN: add to the Terraform code in <code
                                class="language-plaintext highlighter-rouge">main.tf</code> and ask Terraform to apply
                            it!</p>

                    </div>

                    <div class="slide" id="slide-4">

                        <h2 class="slide__title"><span class="slide__num">5</span> Modifying a Resource</h2>

                        <p>As your fictitious environment is coming together, it’s realized that the name of the
                            development subnet isn’t ideal. Rather than calling it <code
                                class="language-plaintext highlighter-rouge">dev_1</code>, this should be changed to
                            just <code class="language-plaintext highlighter-rouge">dev</code>.</p>

                        <p>Because Terraform uses Infrastructure-as-Code (IaC), this can be done with a few minor
                            changes to the <code class="language-plaintext highlighter-rouge">main.tf</code> file and
                            then ask Terraform to apply it. It’s that easy!</p>

                        <p>Modify the existing the <code
                                class="language-plaintext highlighter-rouge">oci_core_subnet.dev_1</code> resource
                            definition in your <code class="language-plaintext highlighter-rouge">main.tf</code> to
                            match the following:</p>

                        <div class="language-terraform highlighter-rouge">
                            <div class="highlight">
                                <pre class="highlight"><code><span class="k">resource</span> <span class="s2">"oci_core_vcn"</span> <span class="s2">"tf_101"</span> <span class="p">{</span>
                      <span class="nx">dns_label</span>             <span class="p">=</span> <span class="s2">"tf101"</span>
                      <span class="nx">cidr_block</span>            <span class="p">=</span> <span class="s2">"172.16.0.0/20"</span>
                      <span class="nx">compartment_id</span>        <span class="p">=</span> <span class="s2">"&lt;your_compartment_OCID_here&gt;"</span>
                      <span class="nx">display_name</span>          <span class="p">=</span> <span class="s2">"tf_101"</span>
                    <span class="p">}</span>
                    
                    <span class="k">resource</span> <span class="s2">"oci_core_subnet"</span> <span class="s2">"dev"</span> <span class="p">{</span>
                      <span class="nx">vcn_id</span>                      <span class="p">=</span> <span class="nx">oci_core_vcn</span><span class="p">.</span><span class="nx">tf_101</span><span class="p">.</span><span class="nx">id</span>
                      <span class="nx">cidr_block</span>                  <span class="p">=</span> <span class="s2">"172.16.0.0/24"</span>
                      <span class="nx">compartment_id</span>              <span class="p">=</span> <span class="s2">"&lt;your_compartment_OCID_here&gt;"</span>
                      <span class="nx">display_name</span>                <span class="p">=</span> <span class="s2">"Dev subnet"</span>
                      <span class="nx">prohibit_public_ip_on_vnic</span>  <span class="p">=</span> <span class="kc">true</span>
                      <span class="nx">dns_label</span>                   <span class="p">=</span> <span class="s2">"dev"</span>
                    <span class="p">}</span>
                    
                    <span class="k">resource</span> <span class="s2">"oci_core_subnet"</span> <span class="s2">"test"</span> <span class="p">{</span>
                      <span class="nx">vcn_id</span>                      <span class="p">=</span> <span class="nx">oci_core_vcn</span><span class="p">.</span><span class="nx">tf_101</span><span class="p">.</span><span class="nx">id</span>
                      <span class="nx">cidr_block</span>                  <span class="p">=</span> <span class="s2">"172.16.1.0/24"</span>
                      <span class="nx">compartment_id</span>              <span class="p">=</span> <span class="s2">"&lt;your_compartment_OCID_here&gt;"</span>
                      <span class="nx">display_name</span>                <span class="p">=</span> <span class="s2">"testing subnet"</span>
                      <span class="nx">prohibit_public_ip_on_vnic</span>  <span class="p">=</span> <span class="kc">true</span>
                      <span class="nx">dns_label</span>                   <span class="p">=</span> <span class="s2">"test"</span>
                    <span class="p">}</span>
                    </code></pre>
                            </div>
                        </div>

                        <p>Now look at the Terraform plan:</p>

                        <div class="language-console highlighter-rouge">
                            <div class="highlight">
                                <pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>terraform plan
                    <span class="gp">oci_core_vcn.tf_101: Refreshing state... [id=ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="gp">oci_core_subnet.dev_1: Refreshing state... [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="gp">oci_core_subnet.test: Refreshing state... [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="gp">oci_core_subnet.stage: Refreshing state... [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="go">
                    An execution plan has been generated and is shown below.
                    Resource actions are indicated with the following symbols:
                      + create
                      - destroy
                    
                    Terraform will perform the following actions:
                    
                    </span><span class="gp">  #</span><span class="w"> </span>oci_core_subnet.dev will be created
                    <span class="go">  + resource "oci_core_subnet" "dev" {
                          + availability_domain        = (known after apply)
                          + cidr_block                 = "172.16.0.0/24"
                    </span><span class="gp">      + compartment_id             = "ocid1.compartment.oc1..&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="go">      + defined_tags               = (known after apply)
                          + dhcp_options_id            = (known after apply)
                          + display_name               = "Dev subnet"
                          + dns_label                  = "dev"
                          + freeform_tags              = (known after apply)
                          + id                         = (known after apply)
                          + ipv6cidr_block             = (known after apply)
                          + ipv6public_cidr_block      = (known after apply)
                          + ipv6virtual_router_ip      = (known after apply)
                          + prohibit_public_ip_on_vnic = true
                          + route_table_id             = (known after apply)
                          + security_list_ids          = (known after apply)
                          + state                      = (known after apply)
                          + subnet_domain_name         = (known after apply)
                          + time_created               = (known after apply)
                    </span><span class="gp">      + vcn_id                     = "ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span>“
                    <span class="go">      + virtual_router_ip          = (known after apply)
                          + virtual_router_mac         = (known after apply)
                        }
                    
                    </span><span class="gp">  #</span><span class="w"> </span>oci_core_subnet.dev_1 will be destroyed
                    <span class="go">  - resource "oci_core_subnet" "dev_1" {
                    </span><span class="gp">      - cidr_block                 = "172.16.0.0/24" -&gt;</span><span class="w"> </span>null
                    <span class="gp">      - compartment_id             = "ocid1.compartment.oc1..&lt;sanitized&gt;</span><span class="s2">" -&gt; null
                    </span><span class="gp">      - defined_tags               = {} -&gt;</span><span class="w"> </span><span class="s2">null
                    </span><span class="gp">      - dhcp_options_id            = "ocid1.dhcpoptions.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"</span> -&gt; null
                    <span class="gp">      - display_name               = "Dev subnet 1" -&gt;</span><span class="w"> </span>null
                    <span class="gp">      - dns_label                  = "dev" -&gt;</span><span class="w"> </span>null
                    <span class="gp">      - freeform_tags              = {} -&gt;</span><span class="w"> </span>null
                    <span class="gp">      - id                         = "ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="s2">" -&gt; null
                    </span><span class="gp">      - prohibit_public_ip_on_vnic = true -&gt;</span><span class="w"> </span><span class="s2">null
                    </span><span class="gp">      - route_table_id             = "ocid1.routetable.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"</span> -&gt; null
                    <span class="go">      - security_list_ids          = [
                    </span><span class="gp">          - "ocid1.securitylist.oc1.phx.&lt;sanitized&gt;</span><span class="s2">",
                    </span><span class="gp">        ] -&gt;</span><span class="w"> </span><span class="s2">null
                    </span><span class="gp">      - state                      = "AVAILABLE" -&gt;</span><span class="w"> </span><span class="s2">null
                    </span><span class="gp">      - subnet_domain_name         = "dev.example.oraclevcn.com" -&gt;</span><span class="w"> </span><span class="s2">null
                    </span><span class="gp">      - time_created               = "2021-02-09 20:22:38.422 +0000 UTC" -&gt;</span><span class="w"> </span><span class="s2">null
                    </span><span class="gp">      - vcn_id                     = "ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"</span> -&gt; null
                    <span class="gp">      - virtual_router_ip          = "172.16.0.1" -&gt;</span><span class="w"> </span>null
                    <span class="gp">      - virtual_router_mac         = "00:11:...:22:33" -&gt;</span><span class="w"> </span>null
                    <span class="go">    }
                    
                    Plan: 1 to add, 0 to change, 1 to destroy.
                    
                    ------------------------------------------------------------------------
                    
                    Note: You didn't specify an "-out" parameter to save this plan, so Terraform
                    can't guarantee that exactly these actions will be performed if
                    "terraform apply" is subsequently run.
                    </span></code></pre>
                            </div>
                        </div>

                        <p>Oh, no — it looks like something has gone terribly awry! Terraform wants to destroy the <code
                                class="language-plaintext highlighter-rouge">dev_1</code> Subnet and create a new <code
                                class="language-plaintext highlighter-rouge">dev</code> subnet.</p>

                        <h3 id="why-is-a-resource-being-deleted-and-re-created">Why is a Resource Being
                            Deleted-and-Re-Created?</h3>

                        <p>There are two primary reasons why a resource might be destroyed and re-created:</p>

                        <ul>
                            <li>Platform (cloud) constraints</li>
                            <li>Renaming a resource name</li>
                        </ul>

                        <p>In OCI, many changes are non-disruptive, however there are some resource changes that might
                            be disruptive. Take for instance the dns_label attribute. According to the <a
                                href="https://registry.terraform.io/providers/hashicorp/oci/latest/docs/resources/core_subnet#dns_label">OCI
                                provider documentation for the Subnet resource</a>, the dns_label cannot be changed.
                            This would mean that if you wanted to change it on an existing OCI Subnet, you could see
                            this delete-and-re-create behavior. Terraform is smart enough to know that if an attribute
                            cannot be updated in-place, then it must delete and re-create the resource.</p>

                        <p>The second situation occurs when you totally change the name of a resource in the Terraform
                            code and don’t ask Terraform to update the Terraform state. From Terraform’s perspective, it
                            looks like you want to delete the old resource (which is present in the Terraform state, but
                            does not exist in the code) and create a net-new resource (because your code refers to a
                            resource that’s non-existent in the Terraform state).</p>

                        <p>This can be a common mistake and be troublesome, but it can be easily resolved. Rename the
                            resource name in the Terraform state from the old name to the new name. Terraform will then
                            move forward as expected. Do this now with the <code
                                class="language-plaintext highlighter-rouge">terraform state mv</code> command:</p>

                        <div class="language-console highlighter-rouge">
                            <div class="highlight">
                                <pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>terraform state <span class="nb">mv </span>oci_core_subnet.dev_1 oci_core_subnet.dev
                    <span class="go">Move "oci_core_subnet.dev_1" to "oci_core_subnet.dev"
                    Successfully moved 1 object(s).
                    </span></code></pre>
                            </div>
                        </div>

                        <p>The above command asks Terraform to rename (move) the old resource name to a new resource
                            name in the Terraform State. Take a look at the <a
                                href="https://www.terraform.io/docs/cli/commands/state/mv.html">Terraform
                                documentation</a> for more information.</p>

                        <blockquote class="notice">
                            <p><strong>NOTE:</strong> When referencing resources in Terraform, the type of resource and
                                its name must be used. This is why in the above command, <code
                                    class="language-plaintext highlighter-rouge">oci_core_subnet.dev_1</code> was used
                                instead of <code class="language-plaintext highlighter-rouge">dev_1</code>.
                                The same name may be used multiple times, as long as it’s used for different types of
                                resources. For instance, an OCI Route Table called <code
                                    class="language-plaintext highlighter-rouge">dev_1</code> could also exist without
                                problem (referenced as <code
                                    class="language-plaintext highlighter-rouge">oci_core_route_table.dev_1</code>).
                                When choosing names for your resources, it’s unnecessary (and a bad idea) to include the
                                type of resource in its name, because the resource type will always prefix the name when
                                referencing it.
                                For example, instead of using <code
                                    class="language-plaintext highlighter-rouge">oci_core_subnet.subnet_dev_1</code>,
                                consider using <code
                                    class="language-plaintext highlighter-rouge">oci_core_subnet.dev_1</code>. It’s
                                clearly visible that this is referencing a Subnet, however the second version is a lot
                                shorter and easier to read!</p>
                        </blockquote>

                        <p>Look at the Terraform plan again:</p>

                        <div class="language-console highlighter-rouge">
                            <div class="highlight">
                                <pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>terraform plan
                    <span class="gp">oci_core_vcn.tf_101: Refreshing state... [id=ocid1.vcn.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="gp">oci_core_subnet.test: Refreshing state... [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="gp">oci_core_subnet.stage: Refreshing state... [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="gp">oci_core_subnet.dev: Refreshing state... [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="go">
                    An execution plan has been generated and is shown below.
                    Resource actions are indicated with the following symbols:
                      ~ update in-place
                    
                    Terraform will perform the following actions:
                    
                    </span><span class="gp">  #</span><span class="w"> </span>oci_core_subnet.dev will be updated <span class="k">in</span><span class="nt">-place</span>
                    <span class="go">  ~ resource "oci_core_subnet" "dev" {
                    </span><span class="gp">      ~ display_name               = "Dev subnet 1" -&gt;</span><span class="w"> </span><span class="s2">"Dev subnet"</span>
                    <span class="gp">        id                         = "ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="gp">        #</span><span class="w"> </span><span class="s2">(15 unchanged attributes hidden)
                    </span><span class="go">    }
                    
                    Plan: 0 to add, 1 to change, 0 to destroy.
                    
                    ------------------------------------------------------------------------
                    
                    Note: You didn't specify an "-out" parameter to save this plan, so Terraform
                    can't guarantee that exactly these actions will be performed if
                    "terraform apply" is subsequently run.
                    </span></code></pre>
                            </div>
                        </div>

                        <p>The tilde (<code class="language-plaintext highlighter-rouge">~</code>) indicates an in-place
                            change, which is what is expected for the display_name. Proceed with applying the change:
                        </p>

                        <div class="language-console highlighter-rouge">
                            <div class="highlight">
                                <pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>terraform apply
                    <span class="go">
                    </span><span class="gp">#</span><span class="w"> </span>...
                    <span class="go">
                    Terraform will perform the following actions:
                    
                    </span><span class="gp">  #</span><span class="w"> </span>oci_core_subnet.dev will be updated <span class="k">in</span><span class="nt">-place</span>
                    <span class="go">  ~ resource "oci_core_subnet" "dev" {
                    </span><span class="gp">      ~ display_name               = "Dev subnet 1" -&gt;</span><span class="w"> </span><span class="s2">"Dev subnet"</span>
                    <span class="gp">        id                         = "ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="s2">"
                    </span><span class="gp">        #</span><span class="w"> </span><span class="s2">(15 unchanged attributes hidden)
                    </span><span class="go">    }
                    
                    Plan: 0 to add, 1 to change, 0 to destroy.
                    
                    Do you want to perform these actions?
                      Terraform will perform the actions described above.
                      Only 'yes' will be accepted to approve.
                    
                      Enter a value: yes
                    
                    </span><span class="gp">oci_core_subnet.dev: Modifying... [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="gp">oci_core_subnet.dev: Modifications complete after 3s [id=ocid1.subnet.oc1.phx.&lt;sanitized&gt;</span><span class="o">]</span>
                    <span class="go">
                    Apply complete! Resources: 0 added, 1 changed, 0 destroyed.
                    </span></code></pre>
                            </div>
                        </div>

                        <p>This tutorial took a slight detour, highlighting a scenario where a resource had to be
                            renamed in the Terraform State to achieve the desired outcome. Your OCI environment now has
                            a VCN with three Subnets in it.</p>

                        <p>We’ve had fun creating new OCI resources and then making modifications to the environment.
                            It’s now time to clean things up. We’ll explore destroying resources in the <a
                                href="/tutorials/tf-101/7-destroying">next lesson</a>.</p>


                    </div>
                </section>
                <!-- /cc01v0 -->


            </main>
        </div>
    </div>
</section> <!-- /F19v0 -->