<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cool Devo Migration</title>
</head>

<body>
    <!--==========================COPY FROM HERE==========================-->





    <!--======================================== EXTERNAL STYLES & CALENDAR ICON========================================-->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style"
        onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="https://cpano.github.io/tutorials-devo/public/css/TutorialsStyles.css">


    <!--========================================HEADER========================================-->
    <!-- CC01v0 -->
    <section style="background-image:url(/a/devo/images/cc01-weblogic-hero-banner.jpg);"
        class="cc01 cc01v0  txtlight cpad">
        <div class="cc01w1 cwidth">

            <h2>Making calls to the Oracle Cloud API using Postman</h2>
            <p>Learn how to make calls directly to the OCI API using Postman.</p>

            <div style="display: flex; color: white;">
                <p class="page__date" style="margin-right: 25px;"><strong><i class="fas fa-user fa-calendar-alt"
                            aria-hidden="true"></i>
                        Author: </strong>
                    Tim Clegg
                </p>

                <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i>
                        Updated:</strong>
                    <time>February 3, 2022</time>
                </p>

            </div>

        </div>
    </section>
    <!-- /CC01v0 -->

    <!-- F19v0 -->
    <section class="f19 f19v0 cpad">
        <div class="f19w1 cwidth">
            <div class="f19w2 f19-2col">
                <div class="f19col f19side">
                    <!-- S20v0 -->
                    <section class="s20 s20v0 cpad" data-ocomid="s20" data-trackas="s20">
                        <div class="s20w1 cwidth">
                            <div class="col-w1">

                                <h3>About Tim Clegg</h3>

                                <!--Social Icons-->
                                <div class="author__urls-wrapper" style="margin-bottom: 15px;">
                                    <ul class="author__urls social-icons">
                                        <li>
                                            <a href="https://www.linkedin.com/in/timothy-clegg/" itemprop="sameAs"
                                                rel="nofollow noopener noreferrer" target="_blank">
                                                <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span
                                                    class="label">LinkedIn</span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="https://github.com/timclegg" itemprop="sameAs"
                                                rel="nofollow noopener noreferrer" target="_blank">
                                                <i class="fab fa-fw fa-github" aria-hidden="true"></i><span
                                                    class="label">GitHub</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <br><br>
                                <!-- End Social Icons-->
                                <p>Code. Share. Secure. Innovate. Automate. Educate.<br></p>

                                <p><strong>More tutorials from this author: </strong>
                                    <span class="tags">


                                        <li><a class="animated-link tag2"
                                                href="/tutorials/tf-101/3-understanding-terraform-basics">Understanding
                                                The Basics Of Terraform</a></li><br>



                                        <li><a class="animated-link tag2" href="/tutorials/tf-101/5-creating">Creating
                                                Resources with Terraform</a></li><br>

                                        <li><a class="animated-link tag2" href="/tutorials/tf-101/6-changing">Making
                                                changes using Terraform</a></li><br>

                                        <li><a class="animated-link tag2"
                                                href="/tutorials/tf-101/7-destroying">Destroying resources with
                                                Terraform</a></li><br>



                                        <li><a class="animated-link tag2" href="/tutorials/steampipe/">Steampipe on
                                                Oracle Cloud Infrastructure</a></li><br><br>

                                     
                                        
                                    </span>
                                </p>

                                <!--Tags-->
                                <h3>Tags</h3>
                                <p> <span class=" tags">
                                        <a class="animated-link tag" href="#">postman</a>
                                        <a class="animated-link tag" href="#">oci</a>
                                        <a class="animated-link tag" href="#">api</a>
                                    </span>
                                </p>

                                <h3></h3>
                                <a href="https://developer.oracle.com/tutorials" '>
                            <p class="page__date" style="margin-right: 25px;"><strong>
                                    Back to tutorials 
                                </strong>
                            </p>
                        </a>

                    </div>
                </div>
            </section>
            <!-- /S20v0 -->
        </div>
        <!-- SET UP -->
        <main class="f19col f19main">
            <!-- cc01v0 -->

            <section class="cc01 cc01v0 cpad" id="link1">
                <div class="cc01w1 cwidth">



        <picture class="alignright">
            <source srcset="https://cool.devo.build/tutorials/assets/pexels-adis-bacinovic-7103901.jpg 1x" />
            <img loading="lazy" width="800" height="534" src="https://cool.devo.build/tutorials/assets/pexels-adis-bacinovic-7103901.jpg" data-original="https://cool.devo.build/tutorials/assets/pexels-adis-bacinovic-7103901.jpg" data-at2x="https://cool.devo.build/tutorials/assets/pexels-adis-bacinovic-7103901@2x.jpg" alt="Mail box" title="Mail box" />
        </picture>

<p><em>Photo credit: Photo by <a href="https://www.pexels.com/@adis-bacinovic-29729722?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels">Adis Bacinovic</a> from <a href="https://www.pexels.com/photo/close-up-shot-of-a-mailbox-7103901/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels">Pexels</a></em></p>

<p>Often when I’m building an automated solution, I’ll look at the <a href="https://registry.terraform.io/providers/hashicorp/oci/latest/docs">documentation for the OCI Terraform Provider</a>. Terraform is my typical go-to tool these days for automating OCI infrastructure, so it’s a logical place to start. Thankfully the OCI Terraform Provider does a good job of sticking pretty close to the OCI API (the terminology it uses, etc.). Sometimes this just doesn’t cut it, though, and I have to dig a level deeper. This is where I typically dive into the <a href="https://docs.oracle.com/en-us/iaas/api/#/?source=:ex:tb:::::WWMK220203P00028:WW_FY22_DevRel_DotBuild&SC=:ex:tb:::::WWMK220203P00028:WW_FY22_DevRel_DotBuild&pcode=WWMK220203P00028">OCI API docs</a>.</p>

<h2 id="the-oci-api">The OCI API</h2>

<p>OCI has a terrific API. In case you’ve not had the pleasure of perusing it, check it out at <a href="https://docs.oracle.com/en-us/iaas/api/#/?source=:ex:tb:::::WWMK220203P00028:WW_FY22_DevRel_DotBuild&SC=:ex:tb:::::WWMK220203P00028:WW_FY22_DevRel_DotBuild&pcode=WWMK220203P00028">docs.oracle.com/en-us/iaas/api</a>. It’s worth digging in to.</p>

<p>To interact with the OCI API, there’s an somewhat involved signing process, which means that you can’t just easily “curl” it with off-the-shelf curl. There are <a href="https://docs.oracle.com/en-us/iaas/Content/API/Concepts/signingrequests.htm?source=:ex:tb:::::WWMK220203P00028:WW_FY22_DevRel_DotBuild&SC=:ex:tb:::::WWMK220203P00028:WW_FY22_DevRel_DotBuild&pcode=WWMK220203P00028">plenty of exmaples</a>, though, making it easier than ever to interact with the OCI API with your favorite language. I’ve shared a quick-and-dirty way to interact with the OCI API using Ruby in <a href="https://blogs.oracle.com/developers/post/making-quick-and-dirty-rest-calls-to-the-oci-api-in-ruby?source=:ex:tb:::::WWMK220203P00028:WW_FY22_DevRel_DotBuild&SC=:ex:tb:::::WWMK220203P00028:WW_FY22_DevRel_DotBuild&pcode=WWMK220203P00028">another article</a> which gives a fast way to access the OCI API with Ruby. The kicker is that this isn’t very easy for me to really explore the OCI API.</p>

<h2 id="interacting-with-the-oci-api">Interacting with the OCI API</h2>

<p>This is where tools like <a href="https://paw.cloud">Paw</a> and <a href="https://www.postman.com">Postman</a> shine. They’re built to make it really easy to interact with APIs. What I need to have handy is a tool that allows me to easily (and quickly) interact with the OCI API. I opted to go with Postman, as it doesn’t require a purchase (at least for the bare-bones functionality).</p>

<p>I started searching for some different options around how to get Postman to send the necessary format and stumbled across this <a href="https://www.ateam-oracle.com/post/invoking-oci-rest-apis-using-postman?source=:ex:tb:::::WWMK220203P00028:WW_FY22_DevRel_DotBuild&SC=:ex:tb:::::WWMK220203P00028:WW_FY22_DevRel_DotBuild&pcode=WWMK220203P00028">great article</a> which covered exactly what I was looking for. I followed the directions, essentially doing the following:</p>

<h2 id="first-try">First try</h2>

<ol>
<li>Cloning the <a href="https://github.com/ashishksingh/postman_collection_for_oci_rest/blob/master/OCI_REST_COLLECTION.postman_collection.json">repo</a></li>
<li>Importing the <code class="language-plaintext highlighter-rouge">OCI_Environment</code> environment</li>
<li>Setting the values for the <code class="language-plaintext highlighter-rouge">tenancyId</code>, <code class="language-plaintext highlighter-rouge">authUserId</code>, <code class="language-plaintext highlighter-rouge">keyFingerprint</code> and <code class="language-plaintext highlighter-rouge">privateKey</code> variables (only setting the <code class="language-plaintext highlighter-rouge">Current Value</code>, not the <code class="language-plaintext highlighter-rouge">Initial Value</code> for each).</li>
<li>Importing the <code class="language-plaintext highlighter-rouge">OCI_REST_INITIALIZATION</code> collection</li>
<li>Running the <code class="language-plaintext highlighter-rouge">ONE_TIME_INITIALIZATION_CALL</code> call within the <code class="language-plaintext highlighter-rouge">OCI_REST_INITIALIZATION</code> collection</li>
<li>Importing the <code class="language-plaintext highlighter-rouge">OCI_REST_COLLECTION</code></li>
<li>Modifying the <code class="language-plaintext highlighter-rouge">GET_OCI_ANNOUNCEMENTS</code> call for the proper endpoint and <code class="language-plaintext highlighter-rouge">compartmentId</code></li>
</ol>

<p>At this point I tried to run <code class="language-plaintext highlighter-rouge">GET_OCI_ANNOUNCEMENTS</code>, but didn’t have any success. I validated all of my credentials and they were correct… What?!  Why?!</p>

<p>I noticed that my API key had a password, but I hadn’t entered it anywhere. This is when I face-palmed myself, realizing that I’d failed to set the <code class="language-plaintext highlighter-rouge">passphrase</code> variable (again, just the <code class="language-plaintext highlighter-rouge">Current value</code>). After doing that, it worked great!</p>

<p>Ugh. Some of the simplest things can present the greatest challenges!</p>

<h2 id="finally-working">Finally working</h2>

<p>To summarize, here are the steps I took that worked for me:</p>

<ol>
<li>Clone the <a href="https://github.com/ashishksingh/postman_collection_for_oci_rest/blob/master/OCI_REST_COLLECTION.postman_collection.json">repo</a></li>
<li>Import the <code class="language-plaintext highlighter-rouge">OCI_Environment</code> environment</li>
<li>Set the values for the <code class="language-plaintext highlighter-rouge">tenancyId</code>, <code class="language-plaintext highlighter-rouge">authUserId</code>, <code class="language-plaintext highlighter-rouge">keyFingerprint</code>, <code class="language-plaintext highlighter-rouge">privateKey</code> and <code class="language-plaintext highlighter-rouge">passphrase</code> variables (only setting the <code class="language-plaintext highlighter-rouge">Current Value</code>, not the <code class="language-plaintext highlighter-rouge">Initial Value</code> for each).</li>
<li>Import the <code class="language-plaintext highlighter-rouge">OCI_REST_INITIALIZATION</code> collection</li>
<li>Run the <code class="language-plaintext highlighter-rouge">ONE_TIME_INITIALIZATION_CALL</code> call within the <code class="language-plaintext highlighter-rouge">OCI_REST_INITIALIZATION</code> collection</li>
<li>Import the <code class="language-plaintext highlighter-rouge">OCI_REST_COLLECTION</code></li>
<li>Modify the <code class="language-plaintext highlighter-rouge">GET_OCI_ANNOUNCEMENTS</code> call for the proper endpoint and <code class="language-plaintext highlighter-rouge">compartmentId</code></li>
</ol>

<p>With that out of the way, I moved forward. I was thrilled by the ability to easily make calls, but I needed the ability to move between different OCI environments easily.</p>

<h2 id="multiple-postman-environments">Multiple Postman Environments</h2>

<p>Postman Environments are designed to allow you to quickly switch as needed. I wanted to leverage a different Postman Environment for each OCI tenancy I needed to access, while using this handy-dandy script. I tried duplicating the <code class="language-plaintext highlighter-rouge">OCI_Environment</code> in the Postman Environment, making sure that the values got moved with it, but that didn’t seem to work. Eventually I found that I was copying the private key contents from one Environment to another, and that the formatting was being stripped/changed (within Postman). The solution was to copy the key contents and paste a fresh copy into the new Environment. Voila,  it worked!</p>

<h2 id="refactoring-the-script">Refactoring the script</h2>

<p>Now, I <em>should</em> have submitted a PR, but I’m writing it here so I can share it for now: to get this super awesome script to work with variables, there are a few small modifications that could be made:</p>

<table>
<thead>
<tr>
  <th>Original line</th>
  <th>New line</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code class="language-plaintext highlighter-rouge">var host = pm.request.url.host.join(".") ;</code></td>
  <td><code class="language-plaintext highlighter-rouge">var host = pm.variables.replaceIn(pm.request.url.host.join("."));</code></td>
</tr>
<tr>
  <td><code class="language-plaintext highlighter-rouge">var escapedTarget = encodeURI(request.url.split(pm.request.url.host.join("."))[1]);</code></td>
  <td><code class="language-plaintext highlighter-rouge">var escapedTarget = encodeURI(pm.variables.replaceIn(request.url.split(pm.request.url.host.join(".")))[1]);</code></td>
</tr>
<tr>
  <td><code class="language-plaintext highlighter-rouge">body = pm.request.body.raw;</code></td>
  <td><code class="language-plaintext highlighter-rouge">body = pm.variables.replaceIn(pm.request.body.raw);</code></td>
</tr>
</tbody>
</table>

<p>The above few changes seem to allow me to use variables, which allows me to greatly extend it.</p>

<h2 id="refactored-call">Refactored call</h2>

<p>Let’s refactor the example given in the code, changing the <code class="language-plaintext highlighter-rouge">GET_OCI_ANNOUNCEMENTS</code> call. Start by adding the following variables:</p>

<table>
<tbody>
<tr>
  <td>Variable Lives In (Type)</td>
  <td>Variable Name</td>
  <td>Variable Value</td>
</tr>
<tr>
  <td><code class="language-plaintext highlighter-rouge">OCI_REST_COLLECTION</code> (Collection)</td>
  <td><code class="language-plaintext highlighter-rouge">oci_domain</code></td>
  <td><code class="language-plaintext highlighter-rouge">oraclecloud.com</code></td>
</tr>
<tr>
  <td><code class="language-plaintext highlighter-rouge">OCI_Environment</code> (or whatever you’re using) (Environment)</td>
  <td><code class="language-plaintext highlighter-rouge">oci_region</code></td>
  <td><code class="language-plaintext highlighter-rouge">&lt;the OCI region you' re talking to&gt;</code></td>
                                    </tr>
                                    </tbody>
                                    </table>

                                    <p>Now go to the <code
                                            class="language-plaintext highlighter-rouge">GET_OCI_ANNOUNCEMENTS</code>
                                        GET call and modify the request path to be: <code
                                            class="language-plaintext highlighter-rouge">https://announcements../20180904/announcements?compartmentId=</code>.
                                        This tells it to use the OCI region specified in the Environment, as well as the
                                        <code class="language-plaintext highlighter-rouge">tenancyId</code> (also
                                        specified in the Environment) and the OCI domain name that’s set in the
                                        Collection.</p>

                                    <h2 id="conclusion">Conclusion</h2>

                                    <p>As usual, something that seemed so cut and dry ended up being quite a bit more
                                        involved. But we’ve got a solution now, and a way to interact with the OCI API
                                        using Postman on our local computer. Yay!</p>





                            </div>
                    </section>
                    <!-- /CC01v0 -->

                    </main>
                </div>
            </div>
    </section>
    <!-- /F19v0 -->




    <!--==========================STOP COPING==========================-->
</body>

</html>