<!--========================================CALENDAR ICON========================================-->
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style"
    onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="https://cpano.github.io/tutorials-devo/public/css/TutorialsStyles.css">

<!--========================================HEADER========================================-->
<!-- CC01v0 -->
<section style="background-image:url(/a/devo/images/cc01-weblogic-hero-banner.jpg);" class="cc01 cc01v0  txtlight cpad">
    <div class="cc01w1 cwidth">

        <h1>Introduction to Steampipe on Oracle Cloud Infrastructure</h1>
        <p>Steampipe is a new open source tool for running queries against cloud resources. </p>

        <div style="display: flex; color: white;">
            <p class="page__date" style="margin-right: 25px;"><strong><i class="fas fa-user fa-calendar-alt"
                        aria-hidden="true"></i>
                    Author: </strong>
                Jon DeCamp
            </p>

            <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong>
                <time>November 24, 2021</time>
            </p>

        </div>

    </div>
</section>
<!-- /CC01v0 -->



<!-- F19v0 -->
<section class="f19 f19v0 cpad">
    <div class="f19w1 cwidth">
        <div class="f19w2 f19-2col">
            <div class="f19col f19side">
                <!-- S20v0 -->
                <section class="s20 s20v0 cpad" data-ocomid="s20" data-trackas="s20">
                    <div class="s20w1 cwidth">
                        <div class="col-w1">

                            <h3>About Jon DeCamp</h3>

                            <!--Social Icons-->
                            <div class="author__urls-wrapper" style="margin-bottom: 15px;">
                                <ul class="author__urls social-icons">

                                    <li>
                                        <a href="https://github.com/jondecamp" itemprop="sameAs"
                                            rel="nofollow noopener noreferrer" target="_blank">
                                            <i class="fab fa-fw fa-github" aria-hidden="true"></i><span
                                                class="label">GitHub</span>
                                        </a>
                                    </li>
                                </ul>
                            </div><br><br>
                            <!-- End Social Icons-->
                            <p>Jon has a passion for infrastructure automation and improving the lives of his customers.
                            </p>

                            <!--Tags-->
                            <h3>Tags</h3>
                            <p> <span class="tags">

                                    <a class="animated-link tag" href="#">steampipe</a>
                                    <a class="animated-link tag" href="#">open-source</a>
                                    <a class="animated-link tag" href="#">iac</a>
                                    <a class="animated-link tag" href="#">devops</a>
                                    <a class="animated-link tag" href="#">get-started</a>
                                </span>
                            </p>

                            <h3></h3>
                            <a href="https://developer.oracle.com/tutorials">
                                <p class="page__date" style="margin-right: 25px;"><strong>
                                        Back to tutorials 
                                    </strong>
                                </p>
                            </a>

                        </div>
                    </div>
                </section>
                <!-- /S20v0 -->
            </div>
            <!-- SET UP -->
            <main class="f19col f19main">
                <!-- cc01v0 -->

                <section class="cc01 cc01v0 cpad" id="link1">
                    <div class="cc01w1 cwidth">

                        <h2>Welcome!</h2>

                        <picture class="alignright">
                            <source srcset="https://cool.devo.build/tutorials/steampipe/assets/pexels-gabriela-palai-507410.jpg" />
                            <img loading="lazy" width="800" src="https://cool.devo.build/tutorials/steampipe/assets/pexels-gabriela-palai-507410.jpg" data-original="https://cool.devo.build/tutorials/steampipe/assets/pexels-gabriela-palai-507410.jpg" data-at2x="https://cool.devo.build/tutorials/steampipe/assets/pexels-gabriela-palai-507410.jpg" />
                        </picture>
            
            <p><em>Photo credit: Photo by <a href="https://www.pexels.com/@gabriela-palai-129458?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels">Gabriela Palai</a> from <a href="https://www.pexels.com/photo/train-with-smoke-507410/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels">Pexels</a></em></p>
            
            <p>I must be virtually hanging out in the wrong circles these days, because <a href="https://steampipe.io/">Steampipe</a> by <a href="https://turbot.com/">Turbot</a> seems like it came out of nowhere. I admit that I haven’t used anything by Turbot in the past, but I’m an instant fan now that I’ve been pulled into the wonderful world of Steampipe.</p>
            
            <h2 id="so-what-is-steampipe">So, what is Steampipe?</h2>
            
            <p>Steampipe is a new open source tool for running queries against cloud resources. It supports multiple cloud providers (plugins), supports a Postgres-like SQL query language, and provides an interactive CLI to navigate through resources. I had the opportunity to perform an evaluation of Steampipe, and I wanted to share some of my experiences. The tool seems to be growing quickly, so I’ll try to link to their excellent documentation whenever I have a chance.</p>
            
            <p>See the <a href="https://steampipe.io/blog/introducing-steampipe">official Steampipe introduction</a> for more background.</p>
            
            <h2 id="how-do-you-install-it">How do you install it?</h2>
            
            <p>Install instructions for Windows, Mac, and Linux are provided on the <a href="https://steampipe.io/downloads">Steampipe webpage</a>. The instructions walk you through using Homebrew if you’re on a Mac, an installer script for Linux, or on Windows via Windows Subsystem for Linux with Ubuntu.</p>
            
            <h2 id="the-oci-plugin">The <abbr title="Oracle Cloud Infrastructure">OCI</abbr> plugin</h2>
            
            <p>Steampipe has a plugin which <a href="https://hub.steampipe.io/plugins/turbot/oci">adds support for Oracle Cloud Infrastructure</a> (<abbr title="Oracle Cloud Infrastructure">OCI</abbr>). You can install the plugin using the syntax below:</p>
            
            <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">steampipe plugin install oci
            </span></code></pre></div></div>
            
            <p>To learn more about the <abbr title="Oracle Cloud Infrastructure">OCI</abbr> plugin, see the <a href="https://hub.steampipe.io/plugins/turbot/oci/tables">documentation and examples at the table level</a>. You can also learn more about the tables available via the plugin using the <code class="language-plaintext highlighter-rouge">.tables</code> and <code class="language-plaintext highlighter-rouge">.inspect</code> commands in the interactive shell.</p>
            
            <p>Once you have the plugin installed, you’re ready to run queries.</p>
            
            <h2 id="basic-functionality">Basic functionality</h2>
            
            <p>The Steampipe <a href="https://steampipe.io/docs">documentation</a> is a thorough reference to the commands and query syntax. I’m no SQL expert, and so I’ll just touch on a few highlights to help you get started.</p>
            
            <p>The query syntax can start as simple as a “select thing from table” and extend far beyond that. For example:</p>
            
            <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">select display_name from oci_kms_vault
            +-----------------------+
            | display_name          |
            +-----------------------+
            | oci-vault1       |
            | oci-vault2       |
            | oci-myvault      |
            </span></code></pre></div></div>
            
            <p>You can store queries in external files and run the queries by specifying the filename on the command line. Let’s look at an example SQL file from the <abbr title="Oracle Cloud Infrastructure">OCI</abbr> Compliance mod (more on this later):</p>
            
            <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span>
              <span class="c1">-- Required Columns</span>
              <span class="n">a</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">resource</span><span class="p">,</span>
              <span class="k">case</span>
                <span class="k">when</span> <span class="n">public_access_type</span> <span class="k">like</span> <span class="s1">'
                                Object%'</span> <span class="k">then</span> <span class="s1">'alarm'</span>
                                <span class="k">else</span> <span class="s1">'ok'</span>
                                <span class="k">end</span> <span class="k">as</span> <span class="n">status</span><span
                                    class="p">,</span>
                                <span class="k">case</span>
                                <span class="k">when</span> <span class="n">public_access_type</span> <span
                                    class="k">like</span> <span class="s1">'Object%'</span> <span class="k">then</span>
                                <span class="n">a</span><span class="p">.</span><span class="n">title</span> <span
                                    class="o">||</span> <span class="s1">' publicly accessible.'</span>
                                <span class="k">else</span> <span class="n">a</span><span class="p">.</span><span
                                    class="n">title</span> <span class="o">||</span> <span class="s1">' not publicly
                                    accessible.'</span>
                                <span class="k">end</span> <span class="k">as</span> <span class="n">reason</span><span
                                    class="p">,</span>
                                <span class="c1">-- Additional Dimensions</span>
                                <span class="n">region</span><span class="p">,</span>
                                <span class="n">coalesce</span><span class="p">(</span><span class="k">c</span><span
                                    class="p">.</span><span class="n">name</span><span class="p">,</span> <span
                                    class="s1">'root'</span><span class="p">)</span> <span class="k">as</span> <span
                                    class="n">compartment</span>
                                <span class="k">from</span>
                                <span class="n">oci_objectstorage_bucket</span> <span class="k">as</span> <span
                                    class="n">a</span>
                                <span class="k">left</span> <span class="k">join</span> <span
                                    class="n">oci_identity_compartment</span> <span class="k">as</span> <span
                                    class="k">c</span> <span class="k">on</span> <span class="k">c</span><span
                                    class="p">.</span><span class="n">id</span> <span class="o">=</span> <span
                                    class="n">a</span><span class="p">.</span><span class="n">compartment_id</span><span
                                    class="p">;</span>
                                </code></pre>
                        </div>
                    </div>

                    <p>And say we have that stored in a file called <code
                            class="language-plaintext highlighter-rouge">objectstorage_bucket_public_access_blocked.sql</code>.
                        You can run this query like so:</p>

                    <div class="language-console highlighter-rouge">
                        <div class="highlight">
                            <pre class="highlight"><code><span class="go">steampipe query objectstorage_bucket_public_access_blocked.sql
            +-----------------------------------------------------------------------------------+--------+---------------------------------------------------+--------------+---------------+
            | resource                                                                          | status | reason                                            | region       | compartment   |
            +-----------------------------------------------------------------------------------+--------+---------------------------------------------------+--------------+---------------+
            </span><span class="gp">| ocid1.bucket.oc1.iad.&lt;sanitized&gt;</span><span class="w"> </span>| ok     | jon-test-rep not publicly accessible.             | us-ashburn-1 | mytest02-dev  |
            <span class="gp">| ocid1.bucket.oc1.phx.&lt;sanitized&gt;</span><span class="w"> </span>| ok     | bootstrap_testing not publicly accessible.        | us-phoenix-1 | mytest02-dev  |
            <span class="gp">| ocid1.bucket.oc1.phx.&lt;sanitized&gt;</span><span class="w"> </span>| ok     | Inventory not publicly accessible.                | us-phoenix-1 | root          |
            <span class="gp">| ocid1.bucket.oc1.phx.&lt;sanitized&gt;</span><span class="w"> </span>| ok     | bucket-20210428-0949 not publicly accessible.     | us-phoenix-1 | mytest03-dev  |
            <span class="gp">| ocid1.bucket.oc1.phx.&lt;sanitized&gt;</span><span class="w"> </span>| ok     | mybucket not publicly accessible.                 | us-phoenix-1 | mytest01-dev  |
            <span class="go">+-----------------------------------------------------------------------------------+--------+---------------------------------------------------+--------------+---------------+
            </span></code></pre>
                        </div>
                    </div>

                    <p>Lastly, you can run an interactive Steampipe shell, which offers more tools for navigating
                        tables, as well as tab completion. Run the steampipe query command to enter the shell. From the
                        shell, you can run queries by typing them out, or by copying and pasting them from an external
                        source.</p>

                    <p>Other helpful commands in the shell (note that they all begin with a dot):</p>

                    <ul>
                        <li><code class="language-plaintext highlighter-rouge">.inspect</code> - inspect the contents of
                            a table</li>
                        <li><code class="language-plaintext highlighter-rouge">.tables</code> - list the tables
                            available to query</li>
                        <li><code class="language-plaintext highlighter-rouge">.output</code> - change the output format
                            (JSON, CSV, or table)</li>
                    </ul>

                    <p>Example of opening the CLI and listing the available tables:</p>

                    <div class="language-console highlighter-rouge">
                        <div class="highlight">
                            <pre class="highlight"><code><span class="go">steampipe query
            Welcome to Steampipe v0.9.0
            For more information, type .help
            </span><span class="gp">&gt;</span><span class="w"> </span>.tables
            <span class="gp"> ==&gt;</span><span class="w"> </span>oci
            <span class="go">+--------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+
            | table                                      | description                                                                                                                    |
            +--------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------+
            | oci_apigateway_api                         | OCI Apigateway Api                                                                                                             |
            | oci_autoscaling_auto_scaling_configuration | OCI Auto Scaling Configuration                                                                                                 |
            | oci_cloud_guard_configuration              | OCI Cloud Guard Configuration                                                                                                  |
            | oci_cloud_guard_detector_recipe            | OCI Cloud Guard Detector Recipe                                                                                                |
            | oci_cloud_guard_managed_list               | OCI Cloud Guard Managed List                                                                                                   |
            | oci_cloud_guard_responder_recipe           | OCI Cloud Guard Responder Recipe                                                                                               |
            | oci_cloud_guard_target                     | OCI Cloud Guard Target                                                                                                         |
            | oci_core_boot_volume_backup                | OCI Core Boot Volume Backup                                                                                                    |
            | oci_core_dhcp_options                      | OCI Core DHCP Options
            </span></code></pre>
                        </div>
                    </div>

                    <h2 id="using-mods-oci-compliance">Using mods (oci compliance)</h2>

                    <p>Mods can be a collection of SQL scripts built for custom reporting. Compliance is an important
                        aspect of what <a
                            href="https://docs.oracle.com/en/solutions/pci-compliant-webapp-terraform?source=:ex:tb:::::WWMK211125P00011:WW_FY22_DevRel_DotBuild&SC=:ex:tb:::::WWMK211125P00011:WW_FY22_DevRel_DotBuild&pcode=WWMK211125P00011">my
                            team works on</a>, and that made finding an <code
                            class="language-plaintext highlighter-rouge">oci_compliance</code> module an exciting
                        discovery. The <code class="language-plaintext highlighter-rouge">oci_compliance</code> mod has
                        Center for Internet Security (CIS) compliance reporting built on top of Steampipe, and that just
                        scratches the surface of the possibilities.</p>

                    <p>Steampipe mods <a href="https://hub.steampipe.io/mods">can be found here</a>.</p>

                    <p>For more information, plus examples and instructions, be sure to visit <a
                            href="https://hub.steampipe.io/mods/turbot/oci_compliance">the oci_compliance page</a>.</p>

                    <p>Let’s install the mod, and run a check for a specific control in this example:</p>

                    <div class="language-console highlighter-rouge">
                        <div class="highlight">
                            <pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>git clone https://github.com/turbot/steampipe-mod-oci-compliance.git
            <span class="go">Cloning into 'steampipe-mod-oci-compliance'...
            remote: Enumerating objects: 254, done.
            remote: Counting objects: 100% (254/254), done.
            remote: Compressing objects: 100% (184/184), done.
            remote: Total 254 (delta 121), reused 155 (delta 61), pack-reused 0
            Receiving objects: 100% (254/254), 468.38 KiB | 949.00 KiB/s, done.
            Resolving deltas: 100% (121/121), done.
             
            </span><span class="gp">$</span><span class="w"> </span><span class="nb">cd </span>steampipe-mod-oci-compliance/
            <span class="go"> 
            </span><span class="gp">$</span><span class="w"> </span>steampipe check control.cis_v110_2_1
            <span class="go"> 
            + 2.1 Ensure no security lists allow ingress from 0.0.0.0/0 to port 22 ................................................................................... 26 / 77 [==========]
              |
              ALARM: Default Security List for ca_vcn contains 1 ingress rule(s) allowing SSH from 0.0.0.0/0. ......................................................... us-ashburn-1 ca_dev
              ALARM: Default Security List for Inventory_VCN contains 1 ingress rule(s) allowing SSH from 0.0.0.0/0. .................................................... us-phoenix-1 root
              ALARM: Default Security List for Primary VCN contains 1 ingress rule(s) allowing SSH from 0.0.0.0/0. ............................................. us-phoenix-1 oci-test
              ALARM: Bastion Security List contains 1 ingress rule(s) allowing SSH from 0.0.0.0/0. ............................................................. us-phoenix-1 oci-test
              OK   : App Security List ingress restricted for SSH from 0.0.0.0/0. .............................................................................. us-phoenix-1 oci-test
              OK   : Wazuh Security List ingress restricted for SSH from 0.0.0.0/0. ............................................................................ us-phoenix-1 oci-test
              OK   : DMZ Security List - Egress ingress restricted for SSH from 0.0.0.0/0. ..................................................................... us-phoenix-1 oci-test
              OK   : DMZ Security List - Ingress ingress restricted for SSH from 0.0.0.0/0. .................................................................... us-phoenix-1 oci-test
            *** OUTPUT CUT ***
            </span></code></pre>
                        </div>
                    </div>

                    <h2 id="wrapping-up">Wrapping Up</h2>

                    <p>Steampipe shows tremendous potential. It’s easier to use Steampipe to query <abbr
                            title="Oracle Cloud Infrastructure">OCI</abbr> resources than it is to remember complex
                        command line options. Results come back fast, especially with a tuned query. Modules provide an
                        additional layer of reporting and glue for the data. I look forward to working with Steampipe
                        and building this tool into my toolbox.</p>


            </div>
</section>
<!-- /CC01v0 -->

</main>
</div>
</div>
</section>
<!-- /F19v0 -->